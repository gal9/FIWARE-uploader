from time import sleep
from kafka import KafkaProducer
from json import dumps

producer = KafkaProducer(bootstrap_servers=['localhost:9092'],
                         value_serializer=lambda x: 
                         dumps(x).encode('utf-8'))

topic = "device_1efe_pred_output"

message = {
    "timestamp": 1646411654,
    "T": "2021-9-30 00:00:00",
    "WA": 5,
    "predicted_profile": [
        20.559133529663086, 20.06004524230957, 20.008737564086914, 19.875843048095703, 19.826507568359375, 19.735532760620117, 19.671180725097656, 19.5283203125,
        19.510326385498047, 19.492237091064453, 19.43628692626953, 19.388273239135742, 19.338472366333008, 19.319091796875, 19.256969451904297, 19.23261833190918,
        19.15015411376953, 19.085248947143555, 19.03643798828125, 18.95341682434082, 18.859600067138672, 18.82411766052246, 18.832395553588867, 18.779903411865234,
        18.737533569335938, 18.738357543945312, 18.6993408203125, 18.649187088012695, 18.631242752075195, 18.578176498413086, 18.515640258789062, 18.49022674560547, 
        8.4593505859375, 18.4080810546875, 18.36920928955078, 18.322742462158203, 18.28092384338379, 18.259933471679688, 18.257587432861328, 18.249736785888672,
        18.24131202697754, 18.186418533325195, 18.17471694946289, 18.178691864013672, 18.179821014404297, 18.178245544433594, 18.152536392211914, 18.10913848876953,
        18.098995208740234, 18.047550201416016, 18.03350257873535, 18.02505111694336, 18.02481460571289, 18.030445098876953, 18.008752822875977, 17.996295928955078,
        17.965824127197266, 17.946840286254883, 17.954761505126953, 17.952289581298828, 17.913734436035156, 17.917055130004883, 17.907180786132812, 17.889965057373047,
        17.845775604248047, 17.8184871673584, 17.808422088623047, 17.79094123840332, 17.76633644104004, 17.75705337524414, 17.75811004638672, 17.7288818359375, 17.73082160949707,
        17.68035125732422, 17.673484802246094, 17.654333114624023, 17.68544578552246, 17.667369842529297, 17.688247680664062]}
array = [
    "2021-9-30 00:00:00",
    "2021-10-1 00:00:00",
    "2021-10-2 00:00:00",
    "2021-10-3 00:00:00",
    "2021-10-4 00:00:00",
    "2021-10-5 00:00:00",
    "2021-10-6 00:00:00",
    "2021-10-7 00:00:00",
    "2021-10-8 00:00:00",
    "2021-10-9 00:00:00"
]

for i in range(10):
    print(i)
    message["timestamp"] = message["timestamp"] + 60000
    message["WA"] = i
    message["T"] = array[i]
    print(topic)
    producer.send(topic, value=message)
    sleep(10)