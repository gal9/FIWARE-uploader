from time import sleep
from kafka import KafkaProducer
from json import dumps

producer = KafkaProducer(bootstrap_servers=['localhost:9092'],
                         value_serializer=lambda x: 
                         dumps(x).encode('utf-8'))

topic = "braila_leakage_groups"

message = {
    "timestamp": 1632743895000,
    "data": {
        "0": [
            "760-A",
            "763-A",
            "751-A",
            "748-A",
            "Jonctiune-J-26",
            "246-A",
            "246-B",
            "Jonctiune-4706",
            "Jonctiune-4615",
            "242-B",
            "242-A",
            "244-B",
            "244-A",
            "243-A",
            "243-B",
            "245-B",
            "245-A",
            "760-B",
            "251-A",
            "251-B",
            "Jonctiune-3422",
            "Jonctiune-3386",
            "763-B",
            "Jonctiune-J-25",
            "Jonctiune-2749",
            "279-A",
            "279-B",
            "Jonctiune-3467",
            "Jonctiune-2750",
            "Jonctiune-J-22",
            "Jonctiune-3425",
            "Jonctiune-J-1",
            "Jonctiune-J-27",
            "Jonctiune-2729",
            "256-A",
            "256-B",
            "Jonctiune-J-19",
            "257-A",
            "257-B",
            "Jonctiune-3956",
            "Jonctiune-J-21",
            "280-A",
            "280-B",
            "Jonctiune-J-3",
            "255-A",
            "255-B",
            "197-B",
            "197-A",
            "Jonctiune-J-32",
            "247-B",
            "247-A",
            "248-A",
            "248-B",
            "Jonctiune-3074",
            "Jonctiune-2202",
            "Jonctiune-2755",
            "Jonctiune-3470",
            "Jonctiune-2734",
            "Jonctiune-3458",
            "Jonctiune-4723",
            "Jonctiune-2208",
            "Jonctiune-3466",
            "Jonctiune-2751",
            "Jonctiune-2753",
            "Jonctiune-2911",
            "Jonctiune-2756",
            "Jonctiune-3920",
            "Jonctiune-3446",
            "Jonctiune-J-10",
            "Jonctiune-2774",
            "Jonctiune-3463",
            "Jonctiune-2752",
            "Jonctiune-2197",
            "Jonctiune-3448",
            "Jonctiune-2730",
            "Jonctiune-3461",
            "Jonctiune-J-33",
            "Jonctiune-3067",
            "Jonctiune-3460",
            "Jonctiune-1224",
            "Jonctiune-1225",
            "Jonctiune-1226",
            "Jonctiune-3917",
            "SenzorChisinau-Titulescu",
            "286-A",
            "286-B",
            "250-B",
            "250-A",
            "249-B",
            "249-A",
            "Jonctiune-J-20",
            "PT3",
            "Jonctiune-J-31",
            "Jonctiune-4602",
            "751-B",
            "281-A",
            "283-B",
            "283-A",
            "281-B",
            "282-A",
            "282-B",
            "Jonctiune-2773",
            "Jonctiune-3464",
            "Jonctiune-4614",
            "Jonctiune-4595",
            "Jonctiune-1872",
            "Jonctiune-3075",
            "288-B",
            "288-A",
            "287-A",
            "287-B",
            "Jonctiune-4618",
            "Jonctiune-2199",
            "PT4",
            "Jonctiune-1638",
            "Jonctiune-2200",
            "748-B",
            "Jonctiune-2206",
            "Jonctiune-2968",
            "Jonctiune-1646",
            "Jonctiune-1637",
            "Jonctiune-J-16",
            "231-A",
            "231-B",
            "Jonctiune-2738",
            "Jonctiune-1636",
            "290-B",
            "290-A",
            "291-B",
            "291-A",
            "Jonctiune-2967"
        ],
        "1": [
            "Jonctiune-3974",
            "Jonctiune-2739",
            "Jonctiune-2207",
            "233-B",
            "233-A",
            "232-A",
            "232-B",
            "236-B",
            "236-A",
            "237-B",
            "237-A",
            "260-B",
            "260-A",
            "259-A",
            "259-B",
            "Jonctiune-1641",
            "261-A",
            "261-B",
            "Jonctiune-2201",
            "Jonctiune-1419",
            "Jonctiune-2203",
            "230-A",
            "230-B",
            "Jonctiune-3068",
            "Jonctiune-J-34",
            "Jonctiune-2204",
            "Jonctiune-2184",
            "Jonctiune-2777",
            "263-B",
            "263-A",
            "Jonctiune-3961",
            "Jonctiune-2195",
            "Jonctiune-1421",
            "Jonctiune-3566",
            "Jonctiune-2194",
            "Jonctiune-2776",
            "Jonctiune-2205",
            "Jonctiune-1635",
            "258-A",
            "258-B",
            "Jonctiune-2736",
            "Jonctiune-1634",
            "229-B",
            "229-A",
            "Jonctiune-2737",
            "Jonctiune-1632",
            "PT1",
            "276-B"
        ],
        "2": [
            "276-A",
            "SenzorComunarzi-castanului",
            "Jonctiune-J-15",
            "Jonctiune-2191",
            "Jonctiune-4743",
            "J-1644",
            "Jonctiune-2879",
            "Jonctiune-1407",
            "254-B",
            "254-A",
            "210-B",
            "210-A",
            "Jonctiune-2192",
            "Jonctiune-2187",
            "Jonctiune-1642",
            "Jonctiune-2190",
            "253-A",
            "253-B",
            "203-A",
            "203-B",
            "Jonctiune-3921",
            "202-B",
            "202-A",
            "Jonctiune-3913",
            "Jonctiune-1606",
            "Jonctiune-3912",
            "Jonctiune-2188",
            "Jonctiune-1405",
            "Jonctiune-2189",
            "199-B",
            "199-A",
            "201-A",
            "201-B",
            "200-B",
            "200-A",
            "Jonctiune-4742",
            "Jonctiune-1406",
            "Jonctiune-3471",
            "216-B",
            "216-A",
            "215-B",
            "215-A",
            "240-A",
            "240-B",
            "Jonctiune-4731",
            "205-A",
            "205-B",
            "Jonctiune-2181",
            "198-B",
            "198-A",
            "Jonctiune-1404",
            "Jonctiune-2193",
            "Jonctiune-2182",
            "Jonctiune-2185",
            "264-B",
            "264-A",
            "266-A",
            "266-B",
            "267-A",
            "267-B",
            "265-A",
            "265-B",
            "Jonctiune-267",
            "Jonctiune-1873",
            "Jonctiune-2744",
            "Jonctiune-1413",
            "206-A",
            "206-B",
            "214-B",
            "214-A",
            "212-A",
            "212-B",
            "213-B",
            "213-A",
            "Jonctiune-2196",
            "Jonctiune-12372",
            "Jonctiune-1415",
            "275-B",
            "275-A"
        ],
        "3": [
            "Jonctiune-2180",
            "Jonctiune-2179",
            "Jonctiune-3967",
            "235-A",
            "235-B",
            "SenzorCernauti-Sebesului",
            "Jonctiune-1610",
            "Jonctiune-3510",
            "Jonctiune-2735",
            "Jonctiune-1414",
            "271-A",
            "271-B",
            "228-B",
            "228-A",
            "226-B",
            "226-A",
            "Jonctiune-1628",
            "PT2",
            "Jonctiune-1875",
            "207-B",
            "207-A",
            "Jonctiune-3972",
            "218-B",
            "218-A",
            "217-A",
            "217-B",
            "Jonctiune-1874",
            "241-A",
            "241-B",
            "Jonctiune-1995",
            "SenzorComunarzi-NatVech",
            "Jonctiune-4619",
            "Jonctiune-2186",
            "269-B",
            "269-A",
            "268-A",
            "268-B",
            "270-A",
            "270-B",
            "Jonctiune-J-23",
            "Jonctiune-1997",
            "Jonctiune-1996",
            "Jonctiune-1998",
            "Jonctiune-2177",
            "Jonctiune-2176",
            "Jonctiune-1616",
            "Jonctiune-2743",
            "Jonctiune-1877"
        ]
    }
}

for i in range(100):
    print(i)
    producer.send(topic, value=message)
    sleep(60)